---
title: My Awesome Catchy Title! # Geef je paper een naam die prikkelt, informatief is, en zo kort mogelijk

author: |
  | Michiel Noback $^1$, Fenna Feenstra $^1$, John Doe $^2$
  | $^1$Hanzehogeschool,  $^2$Een ander instituut

lang: nl # dit zorgt er voor dat "abstract" "samenvatting" gaat heten

abstract: |
  Geef hier je samenvatting in maximaal 150 woorden. Het is een samenvatting van het hele artikel; niet alleen de resultaten! Begin met het belang van dit onderzoek, dan hoe het onderzoek is aangepakt en de belangrijkste resultaten en eindig met de implicaties ervan voor de wetenschap/de maatschappij. Neem nooit figuren of tabellen op in de samenvatting.

bibliography: simple_template.bib # naam van je .bib file. Deze moet hetzelfde zijn als je Rmd bestandsnaam

output:
  bookdown::pdf_document2:
    keep_tex: false    # set this to true if you want to investigate the generated tex
    toc: false         # table of contents
    fig_caption: true  # includes figure captions with numbering in output
    includes:  
        in_header: include_tex_header.tex #will include rules for linespacing and figure floating
---

# Introductie op deze template

**Dit hoofdstuk niet in je eigen paper toevoegen!**

Dit template bevat alle verplichte onderdelen van de paper die je moet schrijven. De titels van de secties mag je NIET wijzigen. Voor elk onderdeel is gegeven wat erin thuis hoort en hoe je dat kan aanpakken. Ook is er aangegeven hoeveel woorden er minimaal en maximaal in de sectie gebruikt mogen worden. In totaal mag je artikel niet minder dan 1000 en niet meer dan 2000 woorden bevatten.

Gebruik de [wordcount plugin](https://github.com/benmarwick/wordcountaddin) om het aantal woorden te tellen van een sectie, en voeg aan het einde een totaal in (zoals al aanwezig in deze template).


## Setup *Chunk* {#setup-chunk}

Aan het begin van je paper kan je een zogenaamde *setup chunk* toevoegen. Hierin kan je het gedrag van `knitr` configureren en de bibliotheken laden die je in je code gebruikt. Hieronder is een voorbeeld van zo'n *setup chunk*.

```{r setup, message=FALSE, warning=FALSE, include=FALSE}
knitr::opts_chunk$set(out.width = '100%', dpi=300) # configuratie voor figuur grootte en resolutie
knitr::opts_chunk$set(echo = FALSE) # Deze regel zorgt ervoor GEEN ENKELE chunk getoond wordt! 
# Laad alle gebruikte bibliotheken hier
library(ggplot2)
library(dplyr)
library(pwr2)
data_set_plants <- read.csv("../raw_data/raw_data_planten.csv")
source("../analyse/scripts/fucntions.R")
```

**NB** Gebruik altijd een naam voor iedere chunk. Dat maakt het *debuggen* van problemen bij het *knitten* van je RMarkdown document veel gemakkelijker.

## Code "*Chunks*" wel of niet tonen

In principe laat je code nooit zien in een publicatie, behalve als de code expliciet besproken wordt en een essentieel onderdeel vormt van je werk. Je kan code gemakkelijk verbergen door gebruik te maken van de optie `echo=FALSE` in de chunk header. Ook storende output kan je eventueel verbergen door gebruik te maken van `message=FALSE` of `warning=FALSE`. Eventueel kan je all chunks in een keer verbergen door dit in je *setup chunk* te plaatsen: `knitr::opts_chunk$set(echo = FALSE)`.

## Referenties / citeren {#refs}

Voor alle secties geldt dat je referenties kan gebruiken naar andere publicaties (externe referenties ofwel citatie) of naar secties, tabellen of figuren in je eigen publicatie (interne referenties). Voor externe referenties gebruik je deze notatie: `[@<ref_key]`, bijvoorbeeld `[@xie2013ddrk]`. Hier gebruik ik hem echt: [@xie2013ddrk]. De *processing engine* zal in het bibliografie bestand zoals opgegeven in de ***yaml header*** van dit bestand (`simple_template.bib`) zoeken naar de referentie met deze naam en vervolgens de hele referentie onderaan in het document opnemen. Kijk vooral in het `.bin` document hoe je deze kan gebruiken. Er zijn voor verschillende soorten bronnen verschillende @annotaties; zie in de `.bib` voor enkele voorbeelden.

Interne referenties naar tabellen, figuren, equations en secties kan je maken door deze syntax te gebruiken: `\@ref(fig:<figuur-naam>)` waarbij `<figuur-naam>` de naam is van het chunk waarin de figuur gemaakt wordt. Hetzelfde werkt voor tabellen: `\@ref(tab:<tabel-naam>)`. Een sectie kan je labelen door er `{#label-naam}` achter te zetten. Bijvoorbeeld, dit `\@ref(setup-chunk)` linkt terug naar de sectie over de setup chunk in sectie [\@ref(setup-chunk)].

Zie ook de hoofdstukken in het geweldige book over [bookdown](https://bookdown.org/yihui/bookdown/) [hier](https://bookdown.org/yihui/bookdown/cross-references.html) en [hier](https://bookdown.org/yihui/rmarkdown-cookbook/cross-ref.html)

Voor de rest: GIYF!

## Taalgebruik

Wetenschappelijk taalgebruik is heel anders dan dagelijks communiceren - laat staan de taal die in online wordt gebruikt in bv Whatsapp of Instagram! Wetenschappelijk taalgebruik is formeel, onpersoonlijk en  ondubbelzinnig.
Een klein voorbeeld: Je schrijft nooit "ik heb de verandering van zoutconcentratie bij langduring huilen onderzocht" maar "de verandering van zoutconcentratie in de tijd bij aanhoudend huilen is onderzocht" 

Natuurlijk moeten spelling en grammatica (zo goed als) foutloos zijn! RStudio heeft redelijk goede spellingscontrole, ook voor Nederlands (alhoewel je deze misschien wel apart moet installeren). Gebruik deze!


Alle volgende onderdelen moet je opnemen in je eigen artikel. Let vooral ook op het minimu

# Introductie

Je start altijd met de maatschappelijke drijfveer voor je onderzoek; waarom is het van belang dat dit onderzoek is uitgevoerd?
Vervolgens bespreek je de achtergronden van je onderzoek. Wat is er al eerder onderzocht op dit vlak en wat mist er juist nog; welke speciale technieken heb je gebruikt? Refereer zorgvuldig naar bronnen die je hebt gebruikt - zie ook paragraaf \@ref(refs).

Je eindigt de introductie met de doelstelling(en) van jouw onderzoek, en hoe je deze doelstellingen denkt te gaan verwezenlijken; de aanpak. Geef hier ook eventuele hypothesen. 

De introductie bevat tussen de 400-800 woorden.


# Materialen en Methoden
Github repo: https://github.com/RamonReilman/blog_ish
Materialen en Methoden beschrijft verhalend wat je hebt gebruikt (data, tools) en wat je hebt gedaan (ontwikkelde methodes). **_Het is essentieel dat dit hoofdstuk je onderzoek reproduceerbaar en valideerbaar maakt_**. Verwijs bij de start van dit hoofdstuk naar je code repository (meestal je github link).

Neem referenties op!

De materialen zijn de meetinstrumenten die je hebt gebruikt, maar ook bijvoorbeeld datasets die je hebt gedownload.

Beschrijf de gebruikte software tools, alsmede de bibliotheken/plugins, met naam, versie, referentie en gebruiksdoel (in dit project). Dit kan eventueel in een tabel an als die lang is mag het een online bijlage zijn.

Beschrijf bestaande methodologieën met hun relevantie voor je project. Geef het doel, de toepassing en welke software en parameters er zijn gebruik. Voeg eventueel een flowchart toe.
Beschrijf de gebruikte statistische methoden.

Beschrijf wat je zelf in het kader van dit onderzoek hebt ontwikkeld aan methodologieën. Geef de naam van scripts/programma’s en waar deze (in je repo) te vinden zijn.

Deze sectie bevat tussen de 400-800 woorden.

Om antwoord te krijgen op onze onderzoeks vraag is de data getest, verwerkt en gevisualiseerd met R.  
-R, versie: 4.4.0  
-Rstudio, versie: 2024.04.1 Build 748

Om de data makkelijk en mooi te visualiseren, maar ook de data te verwerken is de library genaamd tidyverse:2.2.0.  
tidyverse is een collectie van verschillende libraries die data verwerking en visualisatie een stuk makkelijker maakt.
Ook is gebruik gemaakt van Conflicted:1.2.0. Deze library veranderd de manier waarop R met conflicted libraries omgaat.  

In de logboeken is gebruik gemaakt van pwr:1.3.0 en gridExtra:2.3. pwr kan de power van een test berekenen. 
Voor dit onderzoek is pwr ook gebruikt om te kijken wat de sample size moet zijn voor het onderzoek. 
gridExtra is gebruikt om meerdere plotjes op 1 chart te maken, maar dit bleek ook mogelijk te zijn met de facet wrap functie in R.

Voor het testen van de data maken we gebruik van een aantal verschillende testen:
-2 way anova test voor de groei van de plantjes.
-2 way chisq test voor ontkieming van de zaadjes.


# Resultaten
## Duplo's
Aan het einde van de datacollectie is de lengte en de kleur van de plaatjes bepaald van 800 plantjes verspreid over 2 soorten en 4 verschillende zout oplossingen. Omdat er met duplos gewerkt is is er eerst gekeken naar verschil tussen duplo's (figuur 1).
```{r boxplotduplo, warning=FALSE, fig.cap="spreiding van groei (cm) van de 2 soorten over elke oplossing. Deze grafiek geeft de spreiding van de groei van de plantjes weer voor elke oplossing en soort plant. waarbij de x-as de platen soort is en de y-as de groei in cm. Ook zijn de duplo's van elkaar gesplitst, zo kan het verschil tussen deze duplo's gevisualiseerd worden. Uitschieters zijn weergegeven als de zwarte punten."}
# The palette with black:
cbp2 <- c("#56B4E9", "#009E73", "#000000", "#E69F00",
          "#F0E442", "#0072B2", "#D55E00", "#CC79A7")

data_set_plants %>%
    ggplot(aes(x = species, y = groei, fill = as.character(batch))) +
    geom_boxplot() +
    labs(y = "groei (cm)",
         x = "Soort plant",
         fill="duplo") +
    theme_minimal() +
    scale_fill_manual(values = cbp2)+
    facet_wrap(~ oplossing) 
```

De spreiding van groei tussen de duplo's van tuinkers bij een oplossing van 0.09% en 0% is niet heel groot, de boxen liggen zo goed als naast elkaar. Bij 0.06 en 0.03 van de tuinkers blijkt het verschil iets groter. Bij alfalfa zijn de boxen bij 0.09 0.06% niet helemaal even groot, maar de gemiddelden zijn wel gelijk. bij 0 en 0.03% wijken de boxen en gemiddelden meer af van elkaar.   
  

  Bij een aantal duplo's is het niet duidelijk of er een significant verschil tussen zit, om deze reden zijn er t-testen uitgevoerd voor de volgende duplo's: alfalfa en cress bij oplossing 0.03, cress bij oplossing 0.06, en alfalfa bij 0%.  
```{r}
result_test_cress_0.03 <- duplo_test(soort = "cress", get_oplossing = 0.03, data = data_set_plants)
result_test_alfalfa_0.03 <- duplo_test(soort = "alfalfa", get_oplossing = 0.03, data = data_set_plants)
result_test_cress_0.06 <- duplo_test(soort = "cress", get_oplossing = 0.06, data = data_set_plants)

result_test_alfalfa_0.00 <- duplo_test(soort = "alfalfa", get_oplossing = 0, data = data_set_plants)
```
Voor alle 4 de testen geldt p < 0.05, dus er zit bij deze een significant verschil tussen de geteste duplos.  
Om te bepalen of dit verschil relevant is, is Cohen's d berekend.  
```{r}
d_cress_0.03 <- cohens_d_duplo(data = data_set_plants, get_oplossing = 0.03, soort = "cress", get_stats = result_test_cress_0.03$statistic)

d_alfalfa_0.03 <- cohens_d_duplo(data = data_set_plants, get_oplossing = 0.03, soort = "alfalfa", get_stats = result_test_alfalfa_0.03$statistic)

d_cress_0.06 <- cohens_d_duplo(data = data_set_plants, get_oplossing = 0.06, soort = "cress", get_stats = result_test_cress_0.06$statistic)

d_alfalfa_0.00 <- cohens_d_duplo(data = data_set_plants, get_oplossing = 0.00, soort = "alfalfa", get_stats = result_test_alfalfa_0.00$statistic)
```
Cohen's |d| voor cress 0.03% en alfalfa 0.03% ligt rond de 0.85 er kan dus gesproken worden over een groot verschil tussen deze duplo's.
Cohen's |d| voor cress bij 0.06% ligt rond de 0.68, er kan dus gesproken worden over een matig/groot verschil tussen deze duplo's. Cohen's |d| voor alfalfa 0% ligt rond de 0.5, er kan dus over een matig verschil gesproken worden tussen deze duplo's.

## Groei van de planten
Om te bepalen of iets invloed heeft gehad op de groei van een plant is het een goede eerste stap om naar de groei te kijken van een plant. De gemeten groei van elke plant kan gevonden worden in figuur \@ref(fig:cresshist) en \@ref(fig:alfalfahist).

```{r cresshist, fig.cap="Verdeling van groei in cm van cress voor elke oplossing.  Deze grafiek geeft de verdeling weer van de groei van cress voor elke oplossing. Waarbij de x-as de groei in cm is, en de y-as hoeveel deze groei voorkomt. Boven elke grafiek staat een nummer, deze representeert de oplossing."}
data_set_plants %>%
    dplyr::filter(species == "cress") %>%
    ggplot(aes(x=groei,)) +
    geom_histogram(bins = 25,
                   color = "black",
                   fill = "#009E73",)+
    labs(x = "groei (cm)",
         y = "n",
         fill="soort") +
    theme_minimal()+
    scale_fill_manual(values = cbp2)+
    facet_wrap(~ oplossing)+
    coord_cartesian(xlim = c(-1, 30))
```
  
  Wat zichtbaar is uit deze grafiek is dat bij 0.09% de verdeling een stuk meer naar rechts licht dan bij de andere oplossingen. de verdeling van groei bij 0, 0.03 en 0.06 blijkt allemaal wel in de buurt te liggen van elkaar. Alleen is de spreiding bij 0.06 een stuk minder breed.

```{r alfalfahist, fig.cap="Verdeling van groei in cm van alfalfa voor elke oplossing.  Deze grafiek geeft de verdeling weer van de groei van alfalfa voor elke oplossing. Waarbij de x-as de groei in cm is, en de y-as hoeveel deze groei voorkomt. Boven elke grafiek staat een nummer, deze representeert de oplossing."}
data_set_plants %>%
    dplyr::filter(species == "alfalfa") %>%
    ggplot(aes(x=groei,)) +
    geom_histogram(bins = 25,
                   color = "black",
                   fill = "#009E73",)+
    labs(x = "groei (cm)",
         y = "n",
         fill="soort") +
    theme_minimal()+
    scale_fill_manual(values = cbp2)+
    facet_wrap(~ oplossing)
```
  
  Wat zichtbaar is uit deze grafiek is dat de data van de alfalfa veel meer is verspreid dan bij tuinkers. Dit kon ook al gelezen worden uit figuur \@ref(fig:boxplotduplo). Als we deze oplossingen vergelijken met elkaar blijkt er niet veel verschil tussen te zijn. Oplossing 0.06 is de enige die hier wel buiten valt, deze oplossing is de enige met een grote piek.  
Als we de 2 soorten met elkaar vergelijken zien we snel dat tuinkers minder spreiding heeft dan alfalfa.

Om te bepalen of soort, zout en de interactie van deze 2 variabelen invloed heeft op de groei van de planten is een 2-way anova test uitgevoerd. 
```{r}
data_set_plants$oplossing_factor <- factor(data_set_plants$oplossing,
                                           levels = c(0, 0.03, 0.06, 0.09))
data_set_plants$species_factor <- factor(data_set_plants$species,
                                         levels = c("cress", "alfalfa"))


model <- aov(groei ~ oplossing_factor + species_factor + oplossing_factor*species_factor ,data=data_set_plants)
res <- summary(model)
```
Hieruit blijkt dat er een significante interactie is tussen de zout oplossingen en planten soort. (p = 2e-16 < 0.05).


Fisher's eta2 van licht, vocht en de interactie van deze 2 variabelen is berekend om de effect sterkte te bepalen.
```{r}
SS.A <- res[[1]]$Sum[1]
SS.B <- res[[1]]$Sum[2] 
SS.AB <- res[[1]]$Sum[3] 

SS.tot <- sum(res[[1]]$Sum)
eta2.oplossing <- SS.A / SS.tot
eta2.soort <- SS.B / SS.tot
eta2.interactie <- SS.AB / SS.tot
```
De interactie tussen oplossing en soort plant heeft een sterk effect op de groei van de planten (eta2.interactie ~ 0.13).
De verschillende percentages zout hebben een sterk effect gehad op de groei van de planten (eta2.oplossing ~ 0.2).
De 2 soorten hebben een matig effect gehad op de groei van de planten (eta2.soort ~ 0.06).

De pwr van deze test is berekend.
```{r}
a = 4
size.a = 200
b = 2
size.b = 400

x <- pwr.2way(a = a, b=b, alpha = 0.05, size.A=size.a, size.B=size.b, f.A = eta2.oplossing, f.B = eta2.soort)

```
Uit deze berekening is een power van ~96% gekomen.

Er is een log lineaire test uitgevoerd op de verdeling van kleur over soort en oplossing.
```{r}
#head(data_set_plants)
    prop_table_plants <- xtabs(~ species + bladkleur + oplossing, data = data_set_plants)
#    prop_table_plants
#model <- fisher.test(prop_table_plants)
#summary(model)
```
Presenteer je resultaten in een logische volgorde. Beschrijf wat er te zien is en werk toe naar het beantwoorden van je doelstelling. Beschrijf indien mogelijke de logica van de keuze voor opeenvolgende experimenten. In elke paragraaf worden de feitelijke conclusies gegeven (bv ‘de vergelijking laat zien dat het gemiddelde van groep A significant afwijkt van het gemiddelde van groep B, met een p-waarde van … Dit komt niet overeen met de in de literatuur (REF) beschreven waardes.’)

Gebruik zo veel mogelijk figuren om je informatie uit je resultaten over te brengen. Gebruik tabellen wanneer figuren minder geschikt zijn. In de tekst worden figuren en tabellen geïntroduceerd, besproken en de belangrijkste aspecten toegelicht.

Voorzie je figuren van een nummer en een beschrijvende titel. Zorg voor correcte as-labels (eenheid en grootheid), legenda en bijschrift. Hier is een voorbeeldje.

```{r plot-demo, warning=FALSE, fig.cap='Ozon concentraties geplot tegen zonlicht intensiteit, vergeleken over verschillende maanden. Lineaire modellen (blauwe lijnen) en confidence intervals (grijze gebieden) zijn hieraan toegevoegd.'}
airquality$Month_f = factor(airquality$Month, levels = 5:9, labels = month.abb[5:9])
ggplot(data = airquality, mapping = aes(x = Solar.R, y = Ozone)) +
    geom_smooth(method = "lm", formula = y ~ x) +
    geom_point(aes(color = Month_f), alpha = 0.7) + 
    facet_wrap(. ~ Month_f) +
    ylab("Ozone (ppb)") +
    xlab("Solar radiation (lang)") +
    theme(legend.title = element_blank())
```





Geef tabellen bovenaan een titel en bijschrift die de inhoud beschrijft en onderaan voetnoten die kolomnamen of specifieke waardes verklaren.

Deze sectie bevat tussen de 600-1200 woorden.


# Discussie en Conclusies

Formuleer je conclusie door eerst in te zoomen op je eigen data en daarna uit te zoomen. Zoom in door je resultaten samen te vatten. Zoom uit om de waarde van je werk te beoordelen, door je bijvoorbeeld de volgende vragen te stellen: 

- Kunnen mijn resultaten gebruikt worden in het werkveld? 
- Wat betekenen ze voor het werkveld? 
- Zijn mijn data betrouwbaar? 

Bespreek de resultaten zodanig dat je ze ter discussie stelt, wees kritisch. Vergelijk je resultaten met de literatuur of eerder ontwikkelde data. Geef aanbevelingen voor een vervolg en staaf je aanbevelingen door de impact op wetenschappelijk of maatschappelijk vlak te beschrijven. 

Kom ten slotte altijd terug op de doelstelling (en hypothesen).

Deze sectie bevat tussen de 400-800 woorden.


# Online bijlagen

Vaak zijn online bijlagen vele malen groter dan het eigenlijke artikel. Wees nooit bang om te veel aan bijlagen aan te bieden. Je kan hierbij denken aan

- de ruwe data
- de code voor dataverwerking 
- de code voor analyse
- aanvullende figuren en tabellen

Natuurlijk is een git(hub) repo daar de beste plek voor!
Zorg ervoor de je repo logisch is ingericht met goede Readme document(en). 
Ook de code zelf is waar nodig natuurlijk goed gedocumenteerd.



## Wordcount

Voeg aan het eind een woord-telling in:

```{r wordcount, message=FALSE}
#install.packages("devtools")
#devtools::install_github("benmarwick/wordcountaddin", type = "source", dependencies = TRUE, force = TRUE)
wordcountaddin:::text_stats()
```

# Referenties

Een lijst van referenties wordt hier automagisch toegevoegd.
