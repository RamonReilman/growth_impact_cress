---
title: De impact van zout op de groei van kiemgroenten

author: |
  | Ramon Reilman $^1$, Janine Postmys $^1$
  | $^1$Hanze 

lang: nl # dit zorgt er voor dat "abstract" "samenvatting" gaat heten

abstract: |
  Geef hier je samenvatting in maximaal 150 woorden. Het is een samenvatting van het hele artikel; niet alleen de resultaten! Begin met het belang van dit onderzoek, dan hoe het onderzoek is aangepakt en de belangrijkste resultaten en eindig met de implicaties ervan voor de wetenschap/de maatschappij. Neem nooit figuren of tabellen op in de samenvatting.

bibliography: simple_template.bib # naam van je .bib file. Deze moet hetzelfde zijn als je Rmd bestandsnaam

output:
  bookdown::pdf_document2:
    keep_tex: false    # set this to true if you want to investigate the generated tex
    toc: false         # table of contents
    fig_caption: true  # includes figure captions with numbering in output
    includes:  
        in_header: include_tex_header.tex #will include rules for linespacing and figure floating

---

# Introductie op deze template

**Dit hoofdstuk niet in je eigen paper toevoegen!**

Dit template bevat alle verplichte onderdelen van de paper die je moet schrijven. De titels van de secties mag je NIET wijzigen. Voor elk onderdeel is gegeven wat erin thuis hoort en hoe je dat kan aanpakken. Ook is er aangegeven hoeveel woorden er minimaal en maximaal in de sectie gebruikt mogen worden. In totaal mag je artikel niet minder dan 1000 en niet meer dan 2000 woorden bevatten.

Gebruik de [wordcount plugin](https://github.com/benmarwick/wordcountaddin) om het aantal woorden te tellen van een sectie, en voeg aan het einde een totaal in (zoals al aanwezig in deze template).


## Setup *Chunk* {#setup-chunk}

Aan het begin van je paper kan je een zogenaamde *setup chunk* toevoegen. Hierin kan je het gedrag van `knitr` configureren en de bibliotheken laden die je in je code gebruikt. Hieronder is een voorbeeld van zo'n *setup chunk*.

```{r setup, message=FALSE, warning=FALSE, include=FALSE}
knitr::opts_chunk$set(out.width = '100%', dpi=300) # configuratie voor figuur grootte en resolutie
knitr::opts_chunk$set(echo = FALSE) # Deze regel zorgt ervoor GEEN ENKELE chunk getoond wordt! 
# Laad alle gebruikte bibliotheken hier
library(ggplot2)
library(dplyr)
library(pwr)
library(forcats)
data_set_plants <- read.csv("../raw_data/raw_data_planten.csv")
```

**NB** Gebruik altijd een naam voor iedere chunk. Dat maakt het *debuggen* van problemen bij het *knitten* van je RMarkdown document veel gemakkelijker.

## Code "*Chunks*" wel of niet tonen

In principe laat je code nooit zien in een publicatie, behalve als de code expliciet besproken wordt en een essentieel onderdeel vormt van je werk. Je kan code gemakkelijk verbergen door gebruik te maken van de optie `echo=FALSE` in de chunk header. Ook storende output kan je eventueel verbergen door gebruik te maken van `message=FALSE` of `warning=FALSE`. Eventueel kan je all chunks in een keer verbergen door dit in je *setup chunk* te plaatsen: `knitr::opts_chunk$set(echo = FALSE)`.

## Referenties / citeren {#refs}

Voor alle secties geldt dat je referenties kan gebruiken naar andere publicaties (externe referenties ofwel citatie) of naar secties, tabellen of figuren in je eigen publicatie (interne referenties). Voor externe referenties gebruik je deze notatie: `[@<ref_key]`, bijvoorbeeld `[@xie2013ddrk]`. Hier gebruik ik hem echt: [@xie2013ddrk]. De *processing engine* zal in het bibliografie bestand zoals opgegeven in de ***yaml header*** van dit bestand (`simple_template.bib`) zoeken naar de referentie met deze naam en vervolgens de hele referentie onderaan in het document opnemen. Kijk vooral in het `.bin` document hoe je deze kan gebruiken. Er zijn voor verschillende soorten bronnen verschillende @annotaties; zie in de `.bib` voor enkele voorbeelden.

Interne referenties naar tabellen, figuren, equations en secties kan je maken door deze syntax te gebruiken: `\@ref(fig:<figuur-naam>)` waarbij `<figuur-naam>` de naam is van het chunk waarin de figuur gemaakt wordt. Hetzelfde werkt voor tabellen: `\@ref(tab:<tabel-naam>)`. Een sectie kan je labelen door er `{#label-naam}` achter te zetten. Bijvoorbeeld, dit `\@ref(setup-chunk)` linkt terug naar de sectie over de setup chunk in sectie [\@ref(setup-chunk)].

Zie ook de hoofdstukken in het geweldige book over [bookdown](https://bookdown.org/yihui/bookdown/) [hier](https://bookdown.org/yihui/bookdown/cross-references.html) en [hier](https://bookdown.org/yihui/rmarkdown-cookbook/cross-ref.html)

Voor de rest: GIYF!

## Taalgebruik

Wetenschappelijk taalgebruik is heel anders dan dagelijks communiceren - laat staan de taal die in online wordt gebruikt in bv Whatsapp of Instagram! Wetenschappelijk taalgebruik is formeel, onpersoonlijk en  ondubbelzinnig.
Een klein voorbeeld: Je schrijft nooit "ik heb de verandering van zoutconcentratie bij langduring huilen onderzocht" maar "de verandering van zoutconcentratie in de tijd bij aanhoudend huilen is onderzocht" 

Natuurlijk moeten spelling en grammatica (zo goed als) foutloos zijn! RStudio heeft redelijk goede spellingscontrole, ook voor Nederlands (alhoewel je deze misschien wel apart moet installeren). Gebruik deze!


Alle volgende onderdelen moet je opnemen in je eigen artikel. Let vooral ook op het minimu

# Introductie

Dit onderzoek is opgesteld voor een opdracht voor de Hanze in Groningen door twee studenten die de opleiding bio-informatica studeren. In het kader van leren onderzoek doen en resultaatverwerking in programmeertaal R is dit onderzoek tot stand gekomen. Er is gekozen om de impact van zout op de groei van kiemgroenten te onderzoeken. Er is namelijk wel vaker onderzoek gedaan naar de impact van zout op plantengroei (zie bron https://www.bbc.co.uk/bitesize/guides/zqdhjty/revision/6), maar nog niet eerder naar de impact op kiemgroenten. Omdat kiemgroenten gekweekt kunnen worden als voedsel is het belangrijk om te weten wat een verhoogde zoutconcentratie voor impact heeft. Zo kan er bijvoorbeeld gekeken worden naar welke groeilocaties gunstig zouden zijn en welke groeilocaties minder gunstig zouden zijn. <br>

Er is onderzocht wat goede zoutconcentraties zouden kunnen zijn. Het experiment is eenmaal mislukt met te hoge zoutconcentraties, namelijk 0%, 1%, 3%, 9%. Omdat de groep van 1% nog wel groeide is er gekozen om de uiteindelijke concentraties tot maximaal 0.1% te kiezen, namelijk; 0%, 0.03%, 0.06%, 0.09%. Op deze manier is er zekerheid gecreërd dat alles zou groeien, maar dat er alsnog wel een verschil gezien zou gaan worden. <br>

### Hypothese
- De onderzoeksvraag is: Wat is de invloed van verschillende zoutconcentraties op de groei van tuinkers en alfalfa? <br>
- Nulhyopthese: Er is geen invloed van verschillende zoutconcentraties op de groei van tuinkers en alfalfa. <br>
- Hypothese: Een oplopende zoutconcentratie zal een negatieve invloed hebben op de groei van tuinkers en alfalfa. <br>

### Plan van aanpak
De plantjes worden allemaal op 1 locatie ingezaaid op keukenpapier in plastic petrischalen. (Zie protocol ...) Vervolgens worden de plantjes gedurende een periode van 6 dagen continue nat gehouden door de verschillende zoutoplossingen. (Zie protocol ...). Na deze 6 dagen kan worden beslist om de plantjes nog 1 of 2 dagen langer te laten groeien als de groei nog onvoldoende is om goed te kunnen meten, anders wordt op dag 7 de data verzameld. Zorg ervoor dat de bodem nog steeds nat is tot moment van data verzamelen. Na het verzamelen van alle data wordt dit verwerkt in R. Door middel van verschillende plotjes en statistische testen kan er uiteindelijk een conclusie getrokken worden of de hypothese wordt aangenomen of niet. 


# Materialen en Methoden
Github repo: https://github.com/RamonReilman/blog_ish

Er wordt begonnen met het aanschaffen van alle materialen waarbij er op gelet moet worden dat dezelfde merken gekocht worden, bijvoorbeeld het zout moet van 1 merk zijn. De materialen zijn: <br>

- 16 nieuwe petrischalen met deksel <br>
- Spuitflessen, 4 dezelfde <br>
- Keukenrol, 1 rol <br>
- Liniaal, 2 dezelfde <br>
- Tuinkers zaadjes, 3 zakjes <br>
- Alfalfa zaadjes, 3 zakjes <br>
- Computer/laptop met toegang tot Word, Excel en Rstudio <br>

Vervolgens worden de zoutoplossingen gemaakt. Er worden oplossingen gebruikt van 0%, 0.03%, 0.065 en 0.09% zout. Hierbij is de 0% de controlegroep. De planning was dat we dit op een laboratorium zouden doen met gedemineraliseerd water, echter omdat de uitvoering eenmaal mislukt is, moest er een alternatieve oplossing gezocht worden. Hiervoor is gekozen om gekookt leidingwater te gebruiken in combinatie met het zout. Door het koken zijn de bacteriën eruit gehaald en is het water zuiver genoeg om te gebruiken voor het experiment. Vervolgens worden de zaadjes geplant volgens dit schema: <br> 

- Zoutoplossing 0%, 2 keer 50 zaadjes in twee petrischalen. <br>
- Zoutoplossing 0.03%. 2 keer 50 zaadjes in twee petrischalen. <br>
- Zoutoplossing 0.06%. 2 keer 50 zaadjes in twee petrischalen. <br>
- Zoutoplossing 0.09%. 2 keer 50 zaadjes in twee petrischalen. <br>

Alles wordt 2 keer ingezaaid zodat er voor elke oplossing een duplo is. Na het zaaien worden de plantjes gedurdende 6 dagen nat gehouden met de verschillende zoutoplossingen voordat de data verzameld kan worden. De data wordt op 1 dag allemaal tegelijk verzameld door 2 personen. Hierbij neemt 1 persoon alle data voor de Tuinkers op zich en 1 persoon neemt alle data voor de Alfalfa op zich. De volgende datapunten worden hierbij meegenomen. <br>

- Groei in mm <br>
- Ontkiemd ja of nee <br>
- Aantal blaadjes <br>
- Bladkleur (volgens kleurschaal zie ...) <br>

Na het verzamelen van alle data kan dit verwerkt worden in R. Het kan handig zijn gedurende de groei van de plantjes alvast wat statistische tests en plotjes uit te voeren met testdata zodat, tijdens het verwerken van de daadwerkelijke data, al bekend is welke plots en statistische testen er uitgevoerd moeten worden. 

# Resultaten

### Ontkieming
Om te kijken naar hoeveel impact de zoutoplossingen hebben op de groei van de plant wordt gekeken naar de ontkieming van de zaadjes. <br>

```{r, fig.cap= "Ontkieming per soort voor elke oplossing. Deze grafiek geeft het aantal ontkiemde zaadjes weer. Op de x-as staan de oplossingen, op de y-as staat het aantal ontkiemde zaadjes"}
nw_oplossing <- data_set_plants %>%
    filter(oplossing == rep(c(0, 0.03, 0.06, 0.09), each=50)) 

nw_oplossing %>%
    ggplot(aes(x = factor(oplossing), fill = factor(ontkiemt))) +
    geom_bar(position = "dodge") + 
    facet_wrap(~ species) + 
    labs(title = "Ontkiemde zaadjes",
         subtitle = "In zoutoplossing 0% - 0.09%",
         x = "Oplossing", 
         y = "Aantal ontkiemt") +
    scale_fill_brewer(palette = "YlGn") +
    theme_minimal()
```
In figuur 1 is te zien dat bijna alles ontkiemd is, om te kijken of hier nog significant verschil in zit worden er een aantal statistische testen uitgevoerd.<br>

Eerst wordt er een nieuwe dataset gemaak van de ontkieming per soort en oplossing. <br> 
```{r, include=FALSE}
data_set_ontkieming <- data_set_plants %>%
    # Selecteer de juiste kolommen
    select(ontkiemt, species, oplossing) %>%
    # Paste wordt gebruikt om species en oplossing samen te voegen
    # Factor zet een vector om naar een categorie
    mutate(species_oplossing = factor(paste(as.character(species), as.character(oplossing), sep = "-")))

```


```{r, include=FALSE}
# Tabel maken van soort en oplossing van data_set_ontkieming
ontkieming_table <- table(data_set_ontkieming$species,data_set_ontkieming$oplossing + data_set_ontkieming$ontkiemt)
```


```{r, include=FALSE}
# Controleren of alle waarden zijn meegenomen door alles op te tellen
addmargins(ontkieming_table)
```


```{r, include=FALSE}
# 2-way chisq uitvoeren om verschil te kunnen testen
res <- chisq.test(x = ontkieming_table)
(res <- chisq.test(x = ontkieming_table))
cat(sprintf("De p-waarde is groter dan 0.05: %.2f\n", res$p.value))
```


```{r, include=FALSE}
chi2 <- res$statistic
N <- sum(ontkieming_table)
W <- sqrt(chi2 / N)
df <- res$parameter
cat(sprintf("Cohens W: %.3f", W))
```


```{r, include=FALSE}
alpha <- 0.05
pwr.chisq.test(w=W, N=N, df=df, sig.level = alpha)
```


```{r, include=FALSE}
pwr.chisq.test(w = 0.1, df = df, sig.level = 0.05, power = 0.80)
```

Omdat de p-waarde, van de two-way chi-square test met 0.71 groter is dan 0.05 is er geen significant verschil van ontkieming tussen de twee plantensoorten op basis van alle zoutoplossingen. Vervolgens is de effectsterkte berekend door middel van Cohen's M om erachter te komen of het een relevant verschil is. Met een effectgrootte van 0.075 is er nagenoeg geen verband tussen de invloed op ontkiemde zaadjes tussen plant, en zoutoplossingen. Om te controleren of deze conclusie correct is wordt de power berekend met de chi-square test. De power is 0.29 (29%). Daarmee kan gezegd worden dat de vorige testen een 29% kans hebben om correct te zijn. Om te kijken hoeveel metingen er zouden moeten worden uitgevoerd om minimaal 0.8 power (80%) te krijgen is er een power chi-square test uitgevoerd, hieruit komt dat er 1194  planten zouden moeten worden geplant om een power van 0.8 (80%) te krijgen. 


### Aantal blaadjes

Om te kijken hoe de zoutoplossingen impact hebben op de groei van het aantal blaadjes is dit uitgezet in onderstaande barplot. <br>
```{r, fig.cap="Aantal blaadjes per batch per zoutoplossing. Deze barplot geeft het aantal blaadjes per plant per zoutoplossing weer. Op de x-as de zoutoplossingen, op de y-as het aantal blaadjes", echo=FALSE}
data_set_plants %>%
    aggregate(blaadjes ~ species + batch + oplossing, FUN = sum) %>%
    #fct_cross maakt nieuwe kolom en combineert hetgene wat erin staat
    mutate(species_batch = fct_cross(species, as.character(batch), sep = "_")) %>%
    #Fill werkt hier als een split functie voor de batches
    ggplot(aes(x=as.character(oplossing),y=blaadjes, fill=species_batch)) +
    
    labs(title="Barplot sum van blaadjes", 
         subtitle = "Voor 0%-0.09% zout", 
         y="Aantal blaadjes", 
         x="Oplossing zout (in %)", 
         fill = "Batch") +
    
    geom_bar(position = "dodge", stat = "sum",
             color="black", size=0.5) +
    
    scale_fill_brewer(palette = "Dark2") +
    facet_wrap(species~batch) +
    theme_minimal() 
```
In figuur 2 is te zien dat de alfalfa minder blaadjes heeft dan de tuinkers, verder is te zien dat alleen alfalfa in oplossing 0.03% afwijkt qua bladgroei.

### Kleur van blaadjes
Om te kijken wat de invloed van zoutoplossingen is op de groei van de kiemgroenten, is de kleur van de blaadjes verzameld als data. 

```{r, fig.cap="Stacker barchart kleur van blaadjes. Deze grafiek geeft de kleur van de blaadjes weer per soort, batch en oplossing. De kleuren in de bars komen overeen met de kleuren van de plant. Grijs betekend dat er geen bladkleur gemeten is, omdat er geen blaadjes gegroeid zijn."}
# Voorbereiden data
combined_df <- data_set_plants %>%
    filter(oplossing %in% c(0, 0.03, 0.06, 0.09)) %>%
    mutate(oplossing = factor(oplossing)) # oplossingen omzetten naar factor


# Goede kleuren toevoegen
kleuren <- c("licht_groen" = "lightgreen", 
             "donker_groen" = "darkgreen", 
             "groen" = "forestgreen", 
             "geel_groen" = "yellowgreen", 
             "bruin" = "brown", 
             "geen" = "gray", 
             "wit" = "white", 
             "wit_groen" = "palegreen" ,
             "geel" = "yellow")

# Barcharts plotten
ggplot(combined_df, aes(x=oplossing, fill=bladkleur)) +
    geom_bar(position = "stack") +
    scale_fill_manual(values = kleuren) +
    labs(title="Bladkleur van alfalfa en tuinkers",
         x="Oplossing (in%)",
         y="Aantal plantjes",
         fill = "Bladkleur") +
    theme_minimal() + 
    facet_wrap(species~batch)
```
In figuur 3 is te zien welke bladkleur er gemeten is per plant, per batch, per zoutoplossing. Wat opvalt is dat alfalfa batch 1 en alfalaf batch 2 nagenoeg geen bladkleur hebben. 


Geef tabellen bovenaan een titel en bijschrift die de inhoud beschrijft en onderaan voetnoten die kolomnamen of specifieke waardes verklaren.

Deze sectie bevat tussen de 600-1200 woorden.


# Discussie en Conclusies

Formuleer je conclusie door eerst in te zoomen op je eigen data en daarna uit te zoomen. Zoom in door je resultaten samen te vatten. Zoom uit om de waarde van je werk te beoordelen, door je bijvoorbeeld de volgende vragen te stellen: 

- Kunnen mijn resultaten gebruikt worden in het werkveld? 
- Wat betekenen ze voor het werkveld? 
- Zijn mijn data betrouwbaar? 

Bespreek de resultaten zodanig dat je ze ter discussie stelt, wees kritisch. Vergelijk je resultaten met de literatuur of eerder ontwikkelde data. Geef aanbevelingen voor een vervolg en staaf je aanbevelingen door de impact op wetenschappelijk of maatschappelijk vlak te beschrijven. 

Kom ten slotte altijd terug op de doelstelling (en hypothesen).

Deze sectie bevat tussen de 400-800 woorden.


# Online bijlagen

Vaak zijn online bijlagen vele malen groter dan het eigenlijke artikel. Wees nooit bang om te veel aan bijlagen aan te bieden. Je kan hierbij denken aan

- de ruwe data
- de code voor dataverwerking 
- de code voor analyse
- aanvullende figuren en tabellen

Natuurlijk is een git(hub) repo daar de beste plek voor!
Zorg ervoor de je repo logisch is ingericht met goede Readme document(en). 
Ook de code zelf is waar nodig natuurlijk goed gedocumenteerd.



## Wordcount

Voeg aan het eind een woord-telling in:

```{r wordcount, message=FALSE}
#install.packages("devtools")
#devtools::install_github("benmarwick/wordcountaddin", type = "source", dependencies = TRUE, force = TRUE)
wordcountaddin:::text_stats()
```


# Referenties

Een lijst van referenties wordt hier automagisch toegevoegd.
